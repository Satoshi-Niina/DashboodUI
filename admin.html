<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>設定管理 - Dashboard Admin</title>
    <link rel="stylesheet" href="admin.css">
</head>
<body>
    <div class="admin-container">
        <header class="admin-header">
            <h1>🔧 システム設定管理</h1>
            <div class="user-info">
                <span id="admin-user"></span>
                <button id="back-to-main-btn" class="btn-secondary">← メイン画面に戻る</button>
            </div>
        </header>

        <div class="admin-content">
            <div class="info-banner">
                <p>💡 ここで設定を変更すると、再デプロイなしで即座に反映されます</p>
            </div>

            <section class="config-section">
                <h2>アプリケーション URL 設定</h2>
                <p class="section-desc">各サブシステムの接続先URLを設定します</p>

                <form id="config-form">
                    <div class="form-group">
                        <label for="app_url_emergency">
                            🛠️ 応急復旧支援システム
                        </label>
                        <input type="url" 
                               id="app_url_emergency" 
                               name="app_url_emergency"
                               placeholder="https://emergency-client-xxx.run.app"
                               required>
                        <small>完全なURL（https://...）を入力してください</small>
                    </div>

                    <div class="form-group">
                        <label for="app_url_planning">
                            📅 計画・実績管理システム
                        </label>
                        <input type="url" 
                               id="app_url_planning" 
                               name="app_url_planning"
                               placeholder="https://planning-xxx.run.app"
                               required>
                    </div>

                    <div class="form-group">
                        <label for="app_url_equipment">
                            🚛 保守用車管理システム
                        </label>
                        <input type="url" 
                               id="app_url_equipment" 
                               name="app_url_equipment"
                               placeholder="https://equipment-xxx.run.app"
                               required>
                    </div>

                    <div class="form-group">
                        <label for="app_url_failure">
                            ⚠️ 機械故障管理システム
                        </label>
                        <input type="url" 
                               id="app_url_failure" 
                               name="app_url_failure"
                               placeholder="https://failure-xxx.run.app"
                               required>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn-primary">
                            💾 設定を保存
                        </button>
                    </div>
                </form>
            </section>

            <section class="config-section">
                <h2>その他の設定</h2>
                
                <div class="form-group">
                    <label for="cors_origin">
                        🌐 CORS 許可オリジン
                    </label>
                    <input type="text" 
                           id="cors_origin" 
                           name="cors_origin"
                           placeholder="* または https://domain1.com,https://domain2.com">
                    <small>複数指定する場合はカンマ区切り。すべて許可する場合は * を入力</small>
                    <div style="margin-top: 10px; padding: 10px; background: #f0f8ff; border-left: 4px solid #2196F3; border-radius: 4px;">
                        <strong>📌 CORS（Cross-Origin Resource Sharing）とは？</strong><br>
                        異なるドメインからこのサーバーのAPIにアクセスすることを許可するセキュリティ設定です。<br>
                        <br>
                        <strong>設定例：</strong><br>
                        • <code>*</code> - すべてのドメインからのアクセスを許可（開発環境推奨）<br>
                        • <code>https://example.com</code> - 特定のドメインのみ許可（本番環境推奨）<br>
                        • <code>https://app1.com,https://app2.com</code> - 複数ドメインを許可<br>
                        <br>
                        <strong>⚠️ セキュリティ上の注意：</strong><br>
                        本番環境では必要なドメインのみを指定することを強く推奨します。
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" id="save-cors-btn" class="btn-primary">
                        💾 CORS設定を保存
                    </button>
                </div>
            </section>

            <section class="config-section">
                <h2>設定履歴</h2>
                <div id="history-list" class="history-list">
                    <p class="loading">読み込み中...</p>
                </div>
            </section>

            <section class="config-section">
                <h2>ユーザー管理</h2>
                <p class="section-desc">ログインユーザーの追加・編集・削除を行います</p>

                <div class="user-actions">
                    <a href="/user-management" class="btn-primary" style="display: inline-block; text-decoration: none; text-align: center;">
                        👥 ユーザー管理を開く
                    </a>
                </div>
            </section>
        </div>
    </div>

    <div id="toast" class="toast"></div>

    <script src="admin.js"></script>
</body>
</html>
